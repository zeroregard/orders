#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Check if there are changes in the backend directory
if git diff --cached --name-only | grep "^backend/"; then
  cd backend
  echo "🔍 Running backend checks..."
  
  # Run ESLint
  echo "Running ESLint..."
  pnpm lint || {
    echo "❌ ESLint check failed. Please fix the errors and try committing again."
    exit 1
  }
  
  # Run tests
  echo "Running tests..."
  pnpm test || {
    echo "❌ Tests failed. Please fix the failing tests and try committing again."
    exit 1
  }
  
  echo "✅ All backend checks passed!"
fi
